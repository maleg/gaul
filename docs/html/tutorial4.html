<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="description" content="GAUL Documentation: Custom Operators">
   <meta name="keywords" content="crossover, mutation, selection, genetic algorithm, GA, tutorial, examples, documentation, GAUL">
   <meta name="author" content="Stewart Adcock">
   <meta name="copyright" content="© Stewart Adcock">
   <meta name="generator" content="vi">
   <meta http-equiv="Content-Language" content="en">
   <title>GAUL: Genetic Algorithm Utility Library</title>
</head>
<body text="#000000" bgcolor="#D8D8FF" link="#222288" vlink="#222288" alink="#9999FF">

<a NAME="top"></a>
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%">
  <tr>
    <td ALIGN=CENTER BGCOLOR="#000000"><font face="Arial,Helvetica" color="#FFFFFF"> [ <a href="index.html"><font face="Arial,Helvetica" color="#FFFFFF"><b>Home</b></font></a> | <a href="documentation.html"><font face="Arial,Helvetica" color="#FFFFFF"><b>Docs</b></font></a> | <a href="index.html#resources"><font face="Arial,Helvetica" color="#FFFFFF"><b>Resources</b></font></a> | <a href="index.html#distribution"><font face="Arial,Helvetica" color="#FFFFFF"><b>Download</b></font></a>] </font></td>
  </tr>
</table>
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%">
  <tr>
    <td ALIGN=CENTER BGCOLOR="#2222AA"><b><font face="Arial,Helvetica" color="#FFFFFF">GAUL Documentation: Custom Operators</font></b></td>
  </tr>
</table>

<p><a NAME="intro"></a></p>
<table BORDER=0 CELLSPACING=0 CELLPADDING=2 WIDTH="100%">
<tr>
<td>
<p>It is now time to look at the parameters to the &quot;ga_genesis_char()&quot; (and the other genesis functions, including, &quot;ga_genesis_bitstring()&quot; &quot;ga_genesis_integer()&quot;, &quot;ga_genesis_double()&quot; and so on).</p>
<p>The function prototype for the genesis functions, where XXX relates to the built-in chromosome type, is:
<pre>
population *ga_genesis_XXX( const int               population_size,
                            const int               num_chromo,
                            const int               len_chromo,
                            GAgeneration_hook       generation_hook,
                            GAiteration_hook        iteration_hook,
                            GAdata_destructor       data_destructor,
                            GAdata_ref_incrementor  data_ref_incrementor,
                            GAevaluate              evaluate,
                            GAseed                  seed,
                            GAadapt                 adapt,
                            GAselect_one            select_one,
                            GAselect_two            select_two,
                            GAmutate                mutate,
                            GAcrossover             crossover,
                            GAreplace               replace );
</pre>
<p><b>Basic parameters</b></p>
<p>The &quot;population_size&quot; parameter defines the stable size for the population  At any given time the population may be a different size, but this is the maximum number of individuals which will pass into a following generation.</p>
<p>The &quot;num_chromo&quot; parameter specifies the number of chromosomes in the genome.</p>
<p>The &quot;len_chromo&quot; parameter specifies the length of each chromosome, but the exact definition of length is dependent on the chromosome type.  Some chromosome types may ignore this value entirely.</p>
<p><b>Analysis functions</b></p>
<p>&quot;generation_hook&quot; and &quot;iteration_hook&quot; specify callback functions will be called at the beginning of each generation of evolutionary procedures, and each iteration of deterministic optimisation procedures, respectively.  These may safely be defined as &quot;NULL&quot; functions.  As described earlier, these functions may also be used to implement custom termination criteria.</p>
<p><b>Phenome handling functions</b></p>
<p>&quot;data_destructor&quot; and &quot;data_ref_incrementor&quot; specify callback functions which handle memory allocation for user defined (phenomic) data.  These may safely be defined as &quot;NULL&quot; functions, in which case the phenomes are assummed to be either static data, or empty.</p>
<p><b>GA Operator functions</b></p>
<p>The remainder of the parameters define the set of genetic algorithm operators.  Either the built-in functions, or custom functions may be used.  It is perfectly safe to modify the specified functions during an evolutionary run.  As an example of this, we swap between single-point and double-point crossover in the code below.  You may wish to dynamically switch the scoring function, this is also possible.</p>
<p><b>Lower-level functions</b></p>
<p>The genesis functions are high-level convenience functions which encapsulate several lower level GAUL functions.  Sometimes you will need more fine control over the population setup.  Below, a set of equivalent low-level GAUL functions are explained.  These would give you, say, the ability do do things like seed the initial population from a file on disk.  The source code for this extended example is examples/<a href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/~checkout~/gaul/gaul-devel/examples/struggle4.c?content-type=text/plain&amp;only_with_tag=MAIN">struggle4.c</a>.</p>
<p>Our new &quot;main()&quot; function and a set of custom operator functions is:</p>
<pre>

/* Define a pair of crossover operators which will be called alternately. */
void the_other_struggle_crossover( population *pop,
                        entity *father, entity *mother,
                        entity *son, entity *daughter )
  {
  ga_crossover_char_singlepoints(pop, father, mother, son, daughter);
  pop->crossover = struggle_crossover;

  return;
  }

void struggle_crossover( population *pop,
                        entity *father, entity *mother,
                        entity *son, entity *daughter )
  {
  ga_crossover_char_doublepoints(pop, father, mother, son, daughter);
  pop->crossover = the_other_struggle_crossover;

  return;
  }

int main(int argc, char **argv)
  {
  population    *pop=NULL;      /* Population structure. */

  random_init();
  random_seed(42);

/*
 * Allocate a new popuation structure.
 * max. individuals = 400.
 * stable num. individuals = 100.
 * num. chromosomes = 1.
 * length of chromosomes = strlen(target_text);
 */
  pop = ga_population_new( 400, 100, 1, strlen(target_text) );

  if ( !pop ) die("Unable to allocate population.");

/* Define all the needed callback functions. */
  pop->generation_hook = NULL;
  pop->iteration_hook = NULL;
  pop->data_destructor = NULL;
  pop->data_ref_incrementor = NULL;

/* Fitness evaluation. */
  pop->evaluate = struggle_score;

/* Individual initialisation. */
  pop->seed = struggle_seed;

/* Environmental adaptation operator. */
  pop->adapt = struggle_adaptation;

/* Mutation selection operator. */
  pop->select_one = ga_select_one_roulette;

/* Crossover selection operator. */
  pop->select_two = ga_select_two_roulette;

/* Mutation operator. */
  pop->mutate = struggle_mutate;

/* Crossover operator. */
  pop->crossover = struggle_crossover;

/* Replacement operator. (Only used in steady-state evolution) */
  pop->replace = NULL;

/*
 * Seed the initial population. (Could do this manually - it
 * just calls pop->seed() 100 times in this case.)
 */
  ga_population_seed(pop);

/*
 * Set the GA parameters.
 * Crossover ratio = 0.9.
 * Mutation ratio = 0.1.
 * Migration ration = 0.0.
 * Note that custom operator functions may choose to ignore these values.
 */
  ga_population_set_parameters( pop, 0.9, 0.1, 0.0 );

  ga_evolution( pop, GA_CLASS_LAMARCK, GA_ELITISM_PARENTS_SURVIVE, 500 );

  printf( "The final solution with score %f was:\n",
          ga_get_entity_from_rank(pop,0)->fitness );
  printf( "%s\n",
          ga_chromosome_char_to_staticstring(pop, ga_get_entity_from_rank(pop,0)) );

/*
 * This deallocates the population, all individuals, and
 * any genomic and phenomic data that may be associated.
 * (Not quite true - it actually dereferences any phenomic
 * data, which will then be deallocated if appropriate.)
 */
  ga_extinction(pop);

  exit(2);
  }
</pre>
</td>
</tr>
</table>

<p><a NAME="footer"></a></p>
<table BORDER=0 CELLSPACING=0 CELLPADDING=2 WIDTH="100%">
  <tr>
    <td ALIGN=CENTER BGCOLOR="#000000"><font face="Arial,Helvetica" color="#FFFFFF"> [ <a href="index.html"><font face="Arial,Helvetica" color="#FFFFFF"><b>Home</b></font></a> | <a href="documentation.html"><font face="Arial,Helvetica" color="#FFFFFF"><b>Docs</b></font></a> | <a href="index.html#resources"><font face="Arial,Helvetica" color="#FFFFFF"><b>Resources</b></font></a> | <a href="index.html#distribution"><font face="Arial,Helvetica" color="#FFFFFF"><b>Download</b></font></a>] </font></td>
  </tr>
</table>

<!--   Footer, Links etc.  -->
<table BORDER=0 CELLSPACING=2 CELLPADDING=5 WIDTH="100%">
  <tr>
    <td width="20%" ALIGN=CENTER></td>
    <td width="20%" ALIGN=CENTER>Hosted by:<br><A href="http://sourceforge.net"><IMG src="http://sourceforge.net/sflogo.php?group_id=25766" width="88" height="31" border="0" alt="SourceForge Logo"></A></td>
    <td width="20%" ALIGN=CENTER><A href="http://gaul.sourceforge.net/"><IMG src="images/gaul_button.png" width="88" height="31" border="0" alt="GAUL Button"></A></td>
    <td width="20%" ALIGN=CENTER><a href="http://validator.w3.org/check/referer"><img border="0" src="./images/valid-html401.png" alt="Valid HTML 4.01!" width="88" height="31"></a></td>
    <td width="20%" ALIGN=CENTER></td>
  </tr>
</table>

<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%">
  <tr><td><hr noshade width="100%"></td></tr>
  <tr>
    <td ALIGN=CENTER><font face="Arial,Helvetica" size=-1>&copy; 2001-2002, &quot;Stewart Adcock" &lt;<a href="MAILTO:stewart_DOESNOTLIKESPAM@linux-domain.com">stewart@linux-domain.com</a>&gt; All rights reserved.</font></td>
  </tr>
  <tr>
    <td ALIGN=CENTER><font face="Arial,Helvetica" size=-1>All trademarks on this page are probably owned by their respective companies.  You can insert you own favourite disclaimer here.</font></td>
  </tr>
</table>

</body>
</html>

